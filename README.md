# レストランシフト管理システム v3.0

## 📋 プロジェクト概要

レストランのシフト管理を効率化する、和風デザインの白基調Webアプリケーションです。
アルバイトスタッフと正社員が、それぞれの役割に応じてシフトの提出・管理・承認を行えます。

---

## 🎨 デザインコンセプト

**白基調の和風デザイン**
- 和紙のような温かみのある白背景
- 墨色（深い黒・グレー）の落ち着いたテキスト
- 金色（#c9a961）のアクセントカラー
- 細い線と余白を活かした洗練された構成
- 侘び寂びを感じさせるミニマリズム
- さりげない装飾（◆、｜などの和風記号）

---

## ✨ 主な機能

### 🔐 認証システム
- **ログイン機能**: 名前 + 4桁暗証番号
- **アルバイト新規登録**: 個人申請 → 社員承認制
- **マスターキー**: 全アカウント共通（開発者のみ知る）
- **セッション管理**: ログイン状態保持
- **暗証番号変更**: アルバイト・社員ともに可能

### 👥 アルバイト機能
- ✅ 確定シフト閲覧（全員 / 自分のみ 切替可能）
- 📝 次シフトの提出・修正（カレンダー形式）
- 📊 提出状況の確認（提出済み / 未提出）
- 🔄 リアルタイム更新（ログイン状態保持でデータ再読み込み）
- 🔑 暗証番号変更
- 🎭 ローディング演出

### 🏢 社員（kokian）機能
- 📈 シフト提出状況の可視化
  - 提出人数 / 未提出人数
  - 提出者・未提出者リスト（更新日時付き）
- 📋 確定版・収集中シフト表管理
- 🗑️ 3種類の削除機能
  - セル単位（特定人の特定日）
  - スタッフ単位（特定人の全シフト）
  - 日付単位（特定日の全員シフト）
- 🚀 シフト公開機能（次期間の自動生成）
- ⏪ 確定撤回機能（シフトデータは保持）
- 💾 Excel / PDF ダウンロード
- 👤 アカウント管理
  - 承認待ちリスト（承認 / 拒否）
  - 承認済みリスト
  - 暗証番号リセット（1111に戻す）
  - アカウント削除（シフトデータも削除）
- 🔑 暗証番号変更

---

## 🗂️ ファイル構成

```
shift-management-v3/
├── index.html          - メインHTML（外部CSS/JS参照）
├── style.css          - 和風白基調スタイルシート
├── main.js            - アプリケーションロジック
└── README.md          (本ファイル)
```

---

## 🗄️ データベース構造

### 📊 テーブル一覧

#### 1. `accounts` - アカウント情報
| フィールド | 型 | 説明 |
|---------|-----|-----|
| id | text | アカウントID（UUID） |
| username | text | ユーザー名（漢字フルネーム） |
| password | text | 暗証番号（4桁） |
| account_type | text | アカウント種別（staff / manager） |
| status | text | ステータス（pending / approved） |
| created_at | datetime | 登録日時 |
| approved_at | datetime | 承認日時 |

#### 2. `shift_periods` - シフト期間
| フィールド | 型 | 説明 |
|---------|-----|-----|
| id | text | 期間ID（UUID） |
| start_date | text | 開始日（YYYY-MM-DD） |
| end_date | text | 終了日（YYYY-MM-DD） |
| status | text | ステータス（confirmed / collecting / archived） |
| display_name | text | 表示名 |

#### 3. `shifts` - シフトデータ
| フィールド | 型 | 説明 |
|---------|-----|-----|
| id | text | シフトID（UUID） |
| period_id | text | 期間ID |
| staff_name | text | スタッフ名 |
| date | text | 日付（YYYY-MM-DD） |
| shift_type | text | シフト種別（B, C, L, N, CL, BL, BN, CN, OFF） |

---

## 🚀 初期データ

### デフォルトアカウント
- **社員アカウント**: `kokian` / `1111`

### デフォルトシフト期間
- **確定版**: 2025/12/16 〜 2026/01/15
- **収集中**: 2026/01/16 〜 2026/02/15

---

## 📖 利用方法

### 🏁 初回セットアップ

1. **社員ログイン**
   - 名前: `kokian`
   - 暗証番号: `1111`

2. **アルバイトへURL共有**
   - アルバイトに登録用URLを送付

3. **アルバイトアカウント承認**
   - 社員が「アカウント管理」タブで承認

4. **運用開始**

### 👤 アルバイトの使い方

1. **新規登録**
   - ログイン画面で「アカウント登録はこちら」
   - 漢字フルネーム + 4桁暗証番号入力
   - 社員承認を待つ

2. **ログイン後**
   - 「確定シフト」タブ: 今月のシフト確認（全員 / 自分）
   - 「シフト提出」タブ: 来月希望シフト入力
   - 「設定」タブ: 暗証番号変更

3. **シフト提出**
   - カレンダーで日付ごとに選択
   - 「シフトを提出」ボタンで送信
   - 修正も同じ手順

### 🏢 社員の使い方

1. **ログイン**
   - 名前: `kokian`
   - 暗証番号: `1111`（変更推奨）

2. **ダッシュボード**
   - 提出状況をリアルタイム確認
   - 承認待ちアカウントを確認

3. **シフト管理**
   - 「確定版シフト」: 今月確定分
   - 「収集中シフト」: 来月希望分
     - セル / スタッフ / 日付単位で削除可能
     - 手動調整も可能

4. **シフト公開**
   - 「次のシフトを公開」ボタン
   - 収集中 → 確定版に移行
   - 新しい収集期間が自動生成

5. **確定撤回**
   - 誤って公開した場合
   - 「確定を撤回」ボタン
   - 1つ前の状態に戻る（データは保持）

6. **アカウント管理**
   - 承認待ちリスト: 承認 / 拒否
   - 承認済みリスト: 暗証番号リセット / 削除

7. **ダウンロード**
   - Excel形式: シフト表を.xlsxで保存
   - PDF形式: 印刷用にPDFで保存

---

## 🔧 技術スタック

### フロントエンド
- **HTML5**: セマンティックマークアップ
- **CSS3**: 和風白基調デザイン、レスポンシブ対応
- **Vanilla JavaScript**: フレームワーク不使用

### ライブラリ（CDN）
- **SheetJS (xlsx)**: Excelファイル生成
- **jsPDF**: PDFファイル生成
- **jsPDF-AutoTable**: PDF表生成
- **Google Fonts (Noto Serif JP)**: 和風フォント

### バックエンド / データベース
- **RESTful Table API**: データ永続化
  - `GET /tables/{table}` - レコード一覧取得
  - `GET /tables/{table}/{id}` - 単一レコード取得
  - `POST /tables/{table}` - 新規作成
  - `PUT /tables/{table}/{id}` - 完全更新
  - `PATCH /tables/{table}/{id}` - 部分更新
  - `DELETE /tables/{table}/{id}` - 削除

---

## 🔐 セキュリティ

- ✅ ログイン必須（認証なしでアクセス不可）
- ✅ 4桁暗証番号（平文保存 ※本番環境ではハッシュ化推奨）
- ✅ マスターキー（開発者のみ知る共通キー）
- ✅ セッション管理（ログアウトで完全クリア）
- ✅ アカウント承認制（社員による承認必須）

---

## 🚀 デプロイ方法

### 📦 必要なファイル
- `index.html`
- `style.css`
- `main.js`
- `README.md`

### 📍 推奨デプロイ先
- **Vercel**: 静的サイトホスティング
- **Render**: フルスタックアプリケーションホスティング
- **GitHub Pages**: 静的サイトホスティング（ただしAPIは別途必要）

### 🔧 デプロイ手順（Render推奨）
1. **GitHubリポジトリ作成**
   - 上記4ファイルをプッシュ

2. **Renderでデプロイ**
   - Static Siteとして作成
   - Build Command: （不要）
   - Publish Directory: `.`

3. **データベース設定**
   - Render PostgreSQLインスタンス作成
   - API接続設定

---

## 📝 推奨される次のステップ

1. **暗証番号のハッシュ化**: bcryptなどでセキュリティ強化
2. **メール通知**: 承認完了・シフト公開時の自動通知
3. **シフト自動調整**: AIによる最適化
4. **スマホアプリ化**: PWA対応
5. **多店舗対応**: 店舗ごとのシフト管理
6. **勤務時間計算**: 労働時間の自動集計

---

## 🎉 動作確認済み

✅ ファイル構成: 正常
✅ データベース: 3テーブル作成済み
✅ 初期データ: kokian/1111アカウント登録済み
✅ ログイン機能: テスト可能

---

## 🙏 お問い合わせ

システムに関するご質問・ご要望は、開発者までお気軽にご連絡ください。

---

**© 2025 レストランシフト管理システム v3.0**